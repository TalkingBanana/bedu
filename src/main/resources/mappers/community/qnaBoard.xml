<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.care.bedu.community.qna.dao.QnaDAO">
	
	<select id="viewlist" resultType="com.care.bedu.community.qna.vo.QnaVO">
		SELECT QNA_BD_NUM, TITLE, CONTENT, QNA_CNT, QNA_LIKE_YN, USER_ID, QNA_DATE, REG_ID FROM T_BEDU_QNA
		 ORDER BY QNA_BD_NUM DESC
		  LIMIT 5 OFFSET #{page}
	</select>
	
	<insert id="viewWrite">
		INSERT INTO T_BEDU_QNA(USER_ID, title, content, QNA_CNT, QNA_LIKE_YN, QNA_DATE, REG_DATE, REG_ID)
		VALUES(#{user_id}, #{title}, #{content}, #{qna_cnt}, #{qna_like_yn}, SYSDATE(), SYSDATE(), #{reg_id})
	</insert>
	
	<select id="viewone" resultType="com.care.bedu.community.qna.vo.QnaVO">
		SELECT * FROM T_BEDU_QNA
		WHERE QNA_BD_NUM = #{num}
	</select>
	
	<update id="viewupdate">
		UPDATE T_BEDU_QNA SET TITLE = #{title}, CONTENT = #{content}
		WHERE QNA_BD_NUM = #{qna_bd_num}
	</update>
	
	<delete id="viewdelete">
		DELETE FROM T_BEDU_QNA
		WHERE QNA_BD_NUM = #{qnanum}
	</delete>
	
	<select id="viewsearch" resultType="com.care.bedu.community.qna.vo.QnaVO">
		SELECT QNA_BD_NUM, TITLE, CONTENT, USER_ID, QNA_DATE, QNA_CNT, QNA_LIKE_YN, REG_ID FROM T_BEDU_QNA
		<if test="keyword != null">
			WHERE TITLE LIKE concat ('%', #{keyword},'%') OR CONTENT LIKE CONCAT ('%', #{keyword},'%')
			 ORDER BY QNA_BD_NUM DESC
		 </if>
	</select>
	
	<select id="getTotal" resultType="int">
		SELECT COUNT(*) FROM T_BEDU_QNA
	</select>
	
	<update id="qnaCntUp">
		UPDATE T_BEDU_QNA SET QNA_CNT = QNA_CNT + 1
		WHERE QNA_BD_NUM = #{num}
	</update>
	
	<update id="likeUp">
		UPDATE T_BEDU_QNA SET QNA_LIKE_YN = QNA_LIKE_YN + 1
		WHERE QNA_BD_NUM = #{num}
	</update>
	
</mapper>