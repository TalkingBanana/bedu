<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.care.bedu.community.dao.CommunityDAO">
	
	<select id="viewlist" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT COMM_NUM, TITLE, CONTENT, USER_ID, COMM_DATE, COMM_CNT, COMM_LIKE_YN, REG_ID FROM T_BEDU_COMM
		 ORDER BY COMM_NUM DESC
	</select>
	
	<select id="viewsearch" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT COMM_NUM, TITLE, CONTENT, USER_ID, COMM_DATE, COMM_CNT, REG_ID FROM T_BEDU_COMM
		<if test="keyword != null">
			WHERE TITLE LIKE concat ('%', #{keyword},'%') OR CONTENT LIKE CONCAT ('%', #{keyword},'%')
			 ORDER BY COMM_NUM DESC
		 </if>
	</select>
	
	<insert id="viewwrite">
		INSERT INTO t_bedu_comm(USER_ID, TITLE, CONTENT, COMM_CNT, COMM_LIKE_YN, COMM_DATE, REG_DATE, REG_ID)
		VALUES(#{user_id}, #{title}, #{content}, #{comm_cnt}, #{comm_like_yn}, SYSDATE(), SYSDATE(), #{reg_id})
	</insert>
	
	<select id="viewone" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT * FROM t_bedu_comm
		WHERE COMM_NUM = #{num}
	</select>
	
	<delete id="viewdelete">
		DELETE FROM t_bedu_comm
		WHERE COMM_NUM = #{num}
	</delete>
	
	<update id="cntUp">
		UPDATE T_BEDU_COMM SET COMM_CNT = COMM_CNT + 1
		WHERE COMM_NUM = #{num}
	</update>
	
	<update id="viewupdate">
		UPDATE t_bedu_comm SET TITLE = #{title}, CONTENT = #{content}
		WHERE COMM_NUM = #{comm_num}
	</update>
	
	<update id="likeUp">
		UPDATE T_BEDU_COMM SET COMM_LIKE_YN = COMM_LIKE_YN + 1
		WHERE COMM_NUM = #{num}
	</update>
	
	<select id="getTotal" resultType="int">
		SELECT COUNT(*) FROM t_bedu_comm
	</select>
	
</mapper>