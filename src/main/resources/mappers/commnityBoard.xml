<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.care.bedu.community.dao.CommunityDAO">
	
<!--<resultMap id="community" type="com.care.bedu.community.dto.CommunityDTO">
	<result property="comm_num" column="comm_num"/>
	<result property="reg_id" column="reg_id"/>
	<result property="user_id" column="user_id"/>
	<result property="content" column="content"/>
	<result property="comm_date" column="comm_date"/>
	<result property="comm_cnt" column="comm_cnt"/>
	<result property="reg_date" column="reg_date"/>
	<result property="commLikeYn" column="comm_like_yn"/>
</resultMap>-->
	
	<select id="viewlist" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT COMM_NUM, TITLE, CONTENT, USER_ID, COMM_DATE, COMM_CNT, REG_ID FROM t_bedu_comm
		 ORDER BY COMM_NUM DESC
		 LIMIT 10 OFFSET #{page}
	</select>
	
	<select id="viewsearch" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT COMM_NUM, TITLE, CONTENT, USER_ID, COMM_DATE, COMM_CNT, REG_ID FROM t_bedu_comm
		<if test="keyword != null">
			WHERE TITLE LIKE concat ('%', #{keyword},'%') OR CONTENT LIKE CONCAT ('%', #{keyword},'%')
			 ORDER BY COMM_NUM DESC
		 </if>
	</select>
	
	<insert id="viewwrite">
		INSERT INTO t_bedu_comm(USER_ID, TITLE, CONTENT, COMM_DATE, REG_DATE, REG_ID)
		VALUES(#{user_id}, #{title}, #{content}, SYSDATE(), SYSDATE(), #{reg_id})
	</insert>
	
	<select id="viewone" resultType="com.care.bedu.community.dto.CommunityDTO">
		SELECT * FROM t_bedu_comm
		WHERE COMM_NUM = #{num}
	</select>
	
	<delete id="viewdelete">
		DELETE FROM t_bedu_comm
		WHERE COMM_NUM = #{num}
	</delete>
	
	<update id="viewupdate">
		UPDATE t_bedu_comm SET TITLE = #{title}, CONTENT = #{content}
		WHERE COMM_NUM = #{comm_num}
	</update>
	
	<select id="getTotal" resultType="int">
		SELECT COUNT(*) FROM t_bedu_comm
	</select>
	
</mapper>