<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.care.bedu.inquiry.dao.InquiryDAO">

	<select id="inquirylist"
		resultType="com.care.bedu.inquiry.vo.InquiryVO">
		SELECT
		title,
		userName,
		regDate
		FROM
		(
		SELECT
		VOC_NUM as vocNum,
		TITLE AS title,
		USER_NAME AS userName,
		REG_DATE AS regDate
		FROM
		BEDU.T_BEDU_VOC
		ORDER BY
		REG_DATE DESC
		)
	</select>

	<insert id="inquiryWriteSave">
		INSERT INTO T_BEDU_VOC(
		 VOC_NUM,
		 TITLE,
		 CONTENT,
		 FILE_NAME,
		 FILE_TYPE,
		 USER_NAME,
		 REG_DATE,
		 REG_ID
		)VALUES(
		 T_BEDU_VOC_SEQ.NEXTVAL,
		 #{title},
		 #{content},
		 #{fileName},
		 #{fileType},
		 #{userName},
		 SYSDATE,
		 #{regId}
		)
	</insert>

	<select id="inquiryone"
		resultType="com.care.bedu.inquiry.vo.InquiryVO">
		SELECT
		 	VOC_NUM AS vocNum,
			TITLE,
			CONTENT,
			REG_ID as regId
		FROM 
			T_BEDU_VOC
		WHERE VOC_NUM = #{num}
	</select>

	<select id="inquirysearch"
		resultType="com.care.bedu.inquiry.vo.InquiryVO">
		SELECT
		TITLE as title,
		CONTENT as content,
		REG_DATE
		FROM
		T_BEDU_VOC
		<if test="keyword != null">
			WHERE CONTENT LIKE '%'||#{keyword}||'%' OR TITLE LIKE '%'
			|| #{keyword} || '%'
		</if>
		ORDER BY VOC_NUM DESC
	</select>

	<select id="getuserId"
		resultType="com.care.bedu.inquiry.vo.InquiryVO">
		SELECT
		USER_ID
		FROM T_BEDU_USER
		WHERE USER_NAME = #{userName}
	</select>

	<select id="getTotal" resultType="int">
		SELECT COUNT(*) FROM T_BEDU_VOC
	</select>

	<select id="getuserName"
		resultType="com.care.bedu.inquiry.vo.InquiryVO">
		SELECT
		USER_NAME
		FROM T_BEDU_USER
		WHERE USER_ID = #{userId}
	</select>
</mapper>